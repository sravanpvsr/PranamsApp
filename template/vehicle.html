{% extends "base.html" %}
{% load bootstrap4 %}
{% block  myblock %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>



<style>

#id_Room{
   padding:5px;
   width:100%;
}
#id_Vehicle_Available{
   padding:5px;
   width:100%;
}
#id_Member_Occupant{
   padding:5px;
   width:100%;
}
#id_Two_Four_Wheeler{
   padding:5px;
   width:100%;
}

#id_Type_Of_Owner{
   padding:5px;
   width:100%;
}

#id_Sticker_Number_Available{
   padding:5px;
   width:100%;
}

</style>

<script>
    
    function VehicleHide() {
     if(document.getElementById('id_Type_Of_Owner').options[document.getElementById('id_Type_Of_Owner').selectedIndex].value == "notAshramResident") {
            document.getElementById('id_owner_name').disabled = false;
            document.getElementById('id_Mobile').disabled = false;
            document.getElementById('id_Room').disabled = true;
            document.getElementById('id_Member_Occupant').disabled = true;
            
        }
    
     else {
            document.getElementById('id_owner_name').disabled = true;
            document.getElementById('id_Mobile').disabled = true;
            document.getElementById('id_Room').disabled = false;
            document.getElementById('id_Member_Occupant').disabled = false;
        }

        
    }

    function StickerNumberHide(){
      if(document.getElementById('id_Sticker_Number_Available').options[document.getElementById('id_Sticker_Number_Available').selectedIndex].value == "no") {
           
         document.getElementById('id_Existing_Sticker_Number').disabled = true;
            
        }  
        else{
         document.getElementById('id_Existing_Sticker_Number').disabled = false;
        }
    }
    
        
    window.onload = function() {
      document.getElementById('id_Sticker_Number_Available').onchange = StickerNumberHide;  
      document.getElementById('id_Type_Of_Owner').onchange = VehicleHide;
        
        
    };
</script>

<center>
   <br>
   <div  class ="col-md-4 mx-auto">               
           <h4 style="color:rgb(48, 2, 38); font-family:sans-serif;
           background-color:rgb(247, 174, 216);">Vehicle Details</h4>
   </div>
   </center>  
    
    <div  class="container">
      <div style="background-color:rgb(240, 216, 234); " class ="col-md-6 mx-auto">
                        
      <form action="" method="POST" enctype="multipart/form-data">
         {% csrf_token %}
                                             <div class="form-group">
                                                <label for="exampleInputEmail1">{{vehicle_form.Type_Of_Owner.label}}</label>
                                                
                                                {{vehicle_form.Type_Of_Owner}}
                                               
                                              </div> 
                                            <!-- Room Field -->
                                            <div class="form-group">
                                              <label for="exampleInputEmail1">{{vehicle_form.Room.label}}</label>
                                              
                                              {{vehicle_form.Room}}
                                             </div>
                                              
                                             <!-- Member_Occupant -->
                                             <div class="form-group">
                                                <label for="exampleInputEmail1">{{vehicle_form.Member_Occupant.label}}</label>
                                                
                                                {{vehicle_form.Member_Occupant}}
                                               
                                              </div>  
                                              
                                               <!-- Name Field -->
                                                       
                                              <div id="id_member_name">

                                              </div>
                                              <!-- Only for Owners residing outside Ashram -->
                                              

                                             <div>
                                                <label for="exampleInputEmail1">{{vehicle_form.Owner_Name.label}}</label>    
                                                <input type="text" id="id_owner_name" name="Owner_Name" class="form-control"placeholder="Enter Owner Name">
                                             </div>

                                             <div>
                                                <label for="exampleInputEmail1">{{vehicle_form.Mobile.label}}</label>    
                                                <input type="text" id="id_Mobile" name="Mobile" class="form-control"placeholder="Enter Mobile No.">
                                             </div>

                                             <!-- Only for Owners residing outside Ashram Close-->

                                              <!-- Vehicle_No -->
                                             <div class="form-group">
                                                <label for="exampleInputEmail1">{{vehicle_form.Vehicle_No.label}}</label>    
                                                <input type="text" name="Vehicle_No" class="form-control"placeholder="Enter Vehicle No">
                                             
                                             </div> 

                                             

                                             <!-- Two_Four_Wheeler -->
                                             <div class="form-group">
                                                <label for="exampleInputEmail1">{{vehicle_form.Two_Four_Wheeler.label}}</label>    
                                               
                                                {{vehicle_form.Two_Four_Wheeler}}
                                               
                                             
                                             </div> 

                                             <!-- Vehicle Validity -->
                                             <div class="form-group">
                                                <label for="exampleInputEmail1">{{vehicle_form.Validity.label}}</label>    
                                                <input type="text" name="Validity" class="form-control"placeholder="Vehicle Validity">
                                             
                                             </div>  

                                              <!-- DL_No -->
                                              <div class="form-group">
                                                <label for="exampleInputEmail1">{{vehicle_form.DL_No.label}}</label>    
                                                <input type="text" name="DL_No" class="form-control"placeholder="Enter DL No">
                                             
                                             </div>
                                             <!-- DL_Validity -->
                                             <div class="form-group">
                                                <label for="exampleInputEmail1">{{vehicle_form.DL_Validity.label}}</label>    
                                                <input type="text" name="DL_Validity" class="form-control"placeholder="Enter DL Validity">
                                             
                                             </div>       
                                             
                                             
                                              
                                               

                                              <!-- RC_Valid_Upto -->
                                             
                                             <div class="form-group">
                                                <label for="exampleInputEmail1">{{vehicle_form.RC_Valid_Upto.label}}</label>    
                                                <input type="text" name="RC_Valid_Upto" class="form-control"placeholder=" RC Valid Upto">
                                             
                                             </div> 
                                             <!-- Insurance_Valid_Upto -->


                                             <div class="form-group">
                                                <label>{{vehicle_form.Insurance_Valid_Upto.label}}</label>    
                                                <input type="text" name="Insurance_Valid_Upto" class="form-control"placeholder="Insurance Valid Upto">
                                             
                                             </div> 

                                             <div class="form-group">
                                                <label for="exampleInputEmail1">{{vehicle_form.Sticker_Number_Available.label}}</label>    
                                               
                                                {{vehicle_form.Sticker_Number_Available}}
                                               
                                             
                                             </div> 

                                             <!-- Sticker Number -->


                                             <div class="form-group">
                                                <label>{{vehicle_form.Existing_Sticker_Number.label}}</label>    
                                                <input type="text" id="id_Existing_Sticker_Number" name="Existing_Sticker_Number" class="form-control"placeholder="Existing Sticker Number">
                                             
                                             </div> 


                                             <!-- Remarks  -->

                                             <div class="form-group">
                                                <label>{{vehicle_form.Remarks.label}}</label>    
                                                <input type="text" name="Remarks" class="form-control"placeholder="Remarks">
                                             
                                             </div> 
                                         

                                             <!-- Gate_Name -->
                                             <div class="form-group">
                                                <label>{{vehicle_form.Gate_Name.label}}</label> 
                                                {{vehicle_form.Gate_Name}}   
                                                
                                             
                                             </div> 
                                             
                                             <p><input id="id_submit" type="submit" value="Save Details" class="btn btn-primary"></p>
                                            </div>

   
                                              </div>
                                             


                                             
                                          </form>        
    
                                        
    
                                </form>
                        
                </div>
        </div>
    </div>
        

                           
    <script>
 $("#id_Member_Occupant").change(function () { 

        console.log("change")

        const url='{% url "vehicle" %}'
        const Member_Occupant=$(this).val();
        const Room=$("#id_Room").val();

        $.ajax({                       // initialize an AJAX request
            url: url,                    // set the url of the request (= /vehicle/ )
            data: {
                'Member_Occupant': Member_Occupant,
                 'Room':Room      // add Room  to the GET parameters
            },
            success: function (data) {   
                
                //$("#id_city").html(data); 

                 
                 let html_data = '<option value=""></option>';
                 html_data='<label>Name</label>';
                 html_data +='<select name="Member_Name" class="form-control">'
                 data.forEach(function (name) {
                     
                     html_data += `<option name="Member_Name">${name}</option>`
                    
                 });
                 html_data +='</select>'
                 
                 $("#id_member_name").html(html_data);

            
            }
        });





     });
    




 
      </script>
   
    {% if status %}
        <script>
                alert("{{status}}")
        </script>
    {% endif %}
    
    {% if errorStatus %}
        <script>
                alert("{{errorStatus}}")
        </script>
    {% endif %}
    
    {% endblock %}
